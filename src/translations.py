"""Translations for PDF bill generation.

Supported languages: en, de, fr, it.
"""

from __future__ import annotations

_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "bill_title": "Energy Bill",
        "file_prefix": "bill",
        "from": "FROM",
        "to": "TO",
        "billing_period": "Billing period",
        "consumption_cost": "Consumption & Cost",
        "description": "Description",
        "cost": "Cost",
        "revenue": "Revenue",
        "local_solar": "Local (Solar)",
        "grid_bkw": "Grid (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenue",
        "sold_locally": "Local (Solar)",
        "exported_to_grid": "Grid (BKW)",
        "total_cost": "Total cost",
        "total_revenue": "Total revenue",
        "net": "Net",
        "saved_with_solar": "Saved with local solar",
        "you_saved": "You saved {amount} {currency}  -  {pct}% of your energy was local solar!",
        "footer": "Generated by BKW vZEV Calculator",
        "daily_consumption_cost": "Daily Consumption & Cost",
        "daily_production_revenue": "Daily Production & Revenue",
        "day": "Day",
        "local_kwh": "Local (Solar) kWh",
        "grid_kwh": "Grid kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "subtotal": "Subtotal",
        # Month names
        "month_1": "January",
        "month_2": "February",
        "month_3": "March",
        "month_4": "April",
        "month_5": "May",
        "month_6": "June",
        "month_7": "July",
        "month_8": "August",
        "month_9": "September",
        "month_10": "October",
        "month_11": "November",
        "month_12": "December",
    },
    "de": {
        "bill_title": "Energierechnung",
        "file_prefix": "rechnung",
        "from": "VON",
        "to": "AN",
        "billing_period": "Abrechnungszeitraum",
        "consumption_cost": "Verbrauch & Kosten",
        "description": "Beschreibung",
        "cost": "Kosten",
        "revenue": "Ertrag",
        "local_solar": "Lokal (Solar)",
        "grid_bkw": "Netz (BKW)",
        "total": "Total",
        "production_revenue": "Produktion & Ertrag",
        "sold_locally": "Lokal (Solar)",
        "exported_to_grid": "Netz (BKW)",
        "total_cost": "Gesamtkosten",
        "total_revenue": "Gesamtertrag",
        "net": "Netto",
        "saved_with_solar": "Ersparnis mit Solarstrom",
        "you_saved": "Sie sparten {amount} {currency}  -  {pct}% Ihres Stroms war lokaler Solarstrom!",
        "footer": "Erstellt mit BKW vZEV Calculator",
        "daily_consumption_cost": "Tagesverbrauch & Kosten",
        "daily_production_revenue": "Tagesproduktion & Ertrag",
        "day": "Tag",
        "local_kwh": "Lokal (Solar) kWh",
        "grid_kwh": "Netz kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "subtotal": "Zwischentotal",
        "month_1": "Januar",
        "month_2": "Februar",
        "month_3": "Maerz",
        "month_4": "April",
        "month_5": "Mai",
        "month_6": "Juni",
        "month_7": "Juli",
        "month_8": "August",
        "month_9": "September",
        "month_10": "Oktober",
        "month_11": "November",
        "month_12": "Dezember",
    },
    "fr": {
        "bill_title": "Facture d'energie",
        "file_prefix": "facture",
        "from": "DE",
        "to": "A",
        "billing_period": "Periode de facturation",
        "consumption_cost": "Consommation & Couts",
        "description": "Description",
        "cost": "Couts",
        "revenue": "Revenus",
        "local_solar": "Local (Solaire)",
        "grid_bkw": "Reseau (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenus",
        "sold_locally": "Local (Solaire)",
        "exported_to_grid": "Reseau (BKW)",
        "total_cost": "Cout total",
        "total_revenue": "Revenu total",
        "net": "Net",
        "saved_with_solar": "Economise avec le solaire",
        "you_saved": "Vous avez economise {amount} {currency}  -  {pct}% de votre energie etait du solaire local!",
        "footer": "Genere par BKW vZEV Calculator",
        "daily_consumption_cost": "Consommation & Couts journaliers",
        "daily_production_revenue": "Production & Revenus journaliers",
        "day": "Jour",
        "local_kwh": "Local (Solaire) kWh",
        "grid_kwh": "Reseau kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "subtotal": "Sous-total",
        "month_1": "Janvier",
        "month_2": "Fevrier",
        "month_3": "Mars",
        "month_4": "Avril",
        "month_5": "Mai",
        "month_6": "Juin",
        "month_7": "Juillet",
        "month_8": "Aout",
        "month_9": "Septembre",
        "month_10": "Octobre",
        "month_11": "Novembre",
        "month_12": "Decembre",
    },
    "it": {
        "bill_title": "Fattura energetica",
        "file_prefix": "fattura",
        "from": "DA",
        "to": "A",
        "billing_period": "Periodo di fatturazione",
        "consumption_cost": "Consumo & Costi",
        "description": "Descrizione",
        "cost": "Costi",
        "revenue": "Ricavi",
        "local_solar": "Locale (Solare)",
        "grid_bkw": "Rete (BKW)",
        "total": "Totale",
        "production_revenue": "Produzione & Ricavi",
        "sold_locally": "Locale (Solare)",
        "exported_to_grid": "Rete (BKW)",
        "total_cost": "Costo totale",
        "total_revenue": "Ricavo totale",
        "net": "Netto",
        "saved_with_solar": "Risparmio con il solare",
        "you_saved": "Hai risparmiato {amount} {currency}  -  {pct}% della tua energia era solare locale!",
        "footer": "Generato da BKW vZEV Calculator",
        "daily_consumption_cost": "Consumo & Costi giornalieri",
        "daily_production_revenue": "Produzione & Ricavi giornalieri",
        "day": "Giorno",
        "local_kwh": "Locale (Solare) kWh",
        "grid_kwh": "Rete kWh",
        "total_kwh": "Totale kWh",
        "prod_kwh": "Prod. kWh",
        "subtotal": "Subtotale",
        "month_1": "Gennaio",
        "month_2": "Febbraio",
        "month_3": "Marzo",
        "month_4": "Aprile",
        "month_5": "Maggio",
        "month_6": "Giugno",
        "month_7": "Luglio",
        "month_8": "Agosto",
        "month_9": "Settembre",
        "month_10": "Ottobre",
        "month_11": "Novembre",
        "month_12": "Dicembre",
    },
}


def get_translations(language: str) -> dict[str, str]:
    """Return the translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _TRANSLATIONS:
        return _TRANSLATIONS["en"]
    return _TRANSLATIONS[lang]


def get_month_name(language: str, month: int) -> str:
    """Return the localised month name (1-12)."""
    t = get_translations(language)
    return t.get(f"month_{month}", f"Month {month}")


# ===========================================================================
# GUI translations (Streamlit app)
# ===========================================================================

_GUI_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "page_title": "BKW vZEV Calculator",
        "settings": "Settings",
        "csv_directory": "CSV directory",
        "output_directory": "Output directory",
        "database_path": "Database path",
        "collective": "Collective",
        "name": "Name",
        "language": "Language",
        "show_daily_detail": "Show daily detail in PDFs",
        "billing_start": "Billing start",
        "billing_end": "Billing end",
        "billing_interval": "Billing interval",
        "year": "Year",
        "month": "Month",
        "rates": "Rates (CHF/kWh)",
        "local_rate": "Local rate",
        "bkw_buy_rate": "BKW buy rate",
        "bkw_sell_rate": "BKW sell rate",
        "members": "Members",
        "host": "Host",
        "member": "Member",
        "first_name": "First name",
        "last_name": "Last name",
        "street": "Street",
        "zip": "ZIP",
        "city": "City",
        "canton": "Canton",
        "is_host": "Is host",
        "meters": "Meters",
        "external_id": "External ID",
        "production": "Production",
        "virtual": "Virtual",
        "remove_meter": "Remove meter",
        "add_meter": "Add meter",
        "remove_member": "Remove member",
        "add_member": "Add member",
        "save_config": "Save",
        "run_pipeline": "Save & Create Bills",
        "running_bills": "Saving and creating bills...",
        "config_not_found": "config.toml not found. Save the config first.",
        "running_pipeline": "Running pipeline...",
        "pipeline_success": "Pipeline completed successfully.",
        "pipeline_exit_error": "Pipeline exited with an error. Check the log below.",
        "pipeline_failed": "Pipeline failed: {error}",
        "saved_to": "Saved to {path}",
        "log_output": "Log output",
        "generated_files": "Generated files",
        "pdf_bills": "PDF bills",
        "csv_summaries": "CSV summaries",
        "confirm_delete_member": "Delete member?",
        "confirm_delete_member_msg": "Are you sure you want to delete this member? This action cannot be undone.",
        "confirm_delete_meter": "Delete meter?",
        "confirm_delete_meter_msg": "Are you sure you want to delete this meter? This action cannot be undone.",
        "yes_delete": "Yes, delete",
        "cancel": "Cancel",
        # Placeholders for new members/meters
        "placeholder_first_name": "e.g. John",
        "placeholder_last_name": "e.g. Smith",
        "placeholder_street": "e.g. Main Street 12",
        "placeholder_zip": "e.g. 3000",
        "placeholder_city": "e.g. Bern",
        "placeholder_external_id": "e.g. CH1022201234500000000000057725",
        "placeholder_meter_name": "e.g. Consumption Physical",
        # Constraint messages
        "only_one_host": "Only one host allowed. Uncheck the other host first.",
        "max_meters_host": "Host can have maximum 4 meters",
        "max_meters_member": "Member can have maximum 2 meters",
        # Hardcoded meter names
        "meter_consumption_physical": "Consumption Physical",
        "meter_production_physical": "Production Physical",
        "meter_consumption_virtual": "Consumption Virtual",
        "meter_production_virtual": "Production Virtual",
        "add_consumption_meter": "Add consumption meter",
        # Data availability
        "data_availability": "Data Availability",
        "no_data_yet": "No data yet",
        "legend_complete": "■ Complete",
        "legend_partial": "◫ Not complete",
        "legend_none": "· Missing",
        "csv_location_hint": "Place energy CSV files in: {path}",
        "add_production_meter": "Add production meter",
        # Billing intervals
        "interval_monthly": "Monthly",
        "interval_quarterly": "Quarterly",
        "interval_semi_annual": "Semi-annual",
        "interval_annual": "Annual",
    },
    "de": {
        "page_title": "BKW vZEV Rechner",
        "settings": "Einstellungen",
        "csv_directory": "CSV-Verzeichnis",
        "output_directory": "Ausgabeverzeichnis",
        "database_path": "Datenbankpfad",
        "collective": "Gemeinschaft",
        "name": "Name",
        "language": "Sprache",
        "show_daily_detail": "Tagesdetails in PDFs anzeigen",
        "billing_start": "Abrechnungsbeginn",
        "billing_end": "Abrechnungsende",
        "billing_interval": "Abrechnungsintervall",
        "year": "Jahr",
        "month": "Monat",
        "rates": "Tarife (CHF/kWh)",
        "local_rate": "Lokaltarif",
        "bkw_buy_rate": "BKW Bezugstarif",
        "bkw_sell_rate": "BKW Einspeisevergütung",
        "members": "Mitglieder",
        "host": "Gastgeber",
        "member": "Mitglied",
        "first_name": "Vorname",
        "last_name": "Nachname",
        "street": "Strasse",
        "zip": "PLZ",
        "city": "Ort",
        "canton": "Kanton",
        "is_host": "Ist Gastgeber",
        "meters": "Zähler",
        "external_id": "Externe ID",
        "production": "Produktion",
        "virtual": "Virtuell",
        "remove_meter": "Zähler entfernen",
        "add_meter": "Zähler hinzufügen",
        "remove_member": "Mitglied entfernen",
        "add_member": "Mitglied hinzufügen",
        "save_config": "Speichern",
        "run_pipeline": "Speichern & Rechnungen erstellen",
        "running_bills": "Speichern und Rechnungen erstellen...",
        "config_not_found": "config.toml nicht gefunden. Speichern Sie zuerst die Konfiguration.",
        "running_pipeline": "Pipeline wird ausgeführt...",
        "pipeline_success": "Pipeline erfolgreich abgeschlossen.",
        "pipeline_exit_error": "Pipeline mit Fehler beendet. Siehe Log unten.",
        "pipeline_failed": "Pipeline fehlgeschlagen: {error}",
        "saved_to": "Gespeichert in {path}",
        "log_output": "Log-Ausgabe",
        "generated_files": "Generierte Dateien",
        "pdf_bills": "PDF-Rechnungen",
        "csv_summaries": "CSV-Zusammenfassungen",
        "confirm_delete_member": "Mitglied löschen?",
        "confirm_delete_member_msg": "Sind Sie sicher, dass Sie dieses Mitglied löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.",
        "confirm_delete_meter": "Zähler löschen?",
        "confirm_delete_meter_msg": "Sind Sie sicher, dass Sie diesen Zähler löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.",
        "yes_delete": "Ja, löschen",
        "cancel": "Abbrechen",
        # Placeholders for new members/meters
        "placeholder_first_name": "z.B. Max",
        "placeholder_last_name": "z.B. Müller",
        "placeholder_street": "z.B. Hauptstrasse 12",
        "placeholder_zip": "z.B. 3000",
        "placeholder_city": "z.B. Bern",
        "placeholder_external_id": "z.B. CH1022201234500000000000057725",
        "placeholder_meter_name": "z.B. Verbrauch Physisch",
        # Constraint messages
        "only_one_host": "Nur ein Gastgeber erlaubt. Deaktivieren Sie zuerst den anderen Gastgeber.",
        "max_meters_host": "Gastgeber kann maximal 4 Zähler haben",
        "max_meters_member": "Mitglied kann maximal 2 Zähler haben",
        # Hardcoded meter names
        "meter_consumption_physical": "Verbrauch Physisch",
        "meter_production_physical": "Produktion Physisch",
        "meter_consumption_virtual": "Verbrauch Virtuell",
        "meter_production_virtual": "Produktion Virtuell",
        "add_consumption_meter": "Verbrauchszähler hinzufügen",
        "add_production_meter": "Produktionszähler hinzufügen",
        # Billing intervals
        "interval_monthly": "Monatlich",
        "interval_quarterly": "Quartalsweise",
        "interval_semi_annual": "Halbjährlich",
        "interval_annual": "Jährlich",
        # Data availability
        "data_availability": "Datenverfügbarkeit",
        "no_data_yet": "Noch keine Daten",
        "legend_complete": "■ Vollständig",
        "legend_partial": "◫ Unvollständig",
        "legend_none": "· Fehlt",
        "csv_location_hint": "Energie-CSV-Dateien ablegen in: {path}",
    },
    "fr": {
        "page_title": "Calculateur BKW vZEV",
        "settings": "Parametres",
        "csv_directory": "Repertoire CSV",
        "output_directory": "Repertoire de sortie",
        "database_path": "Chemin base de donnees",
        "collective": "Collectif",
        "name": "Nom",
        "language": "Langue",
        "show_daily_detail": "Afficher details journaliers dans les PDFs",
        "billing_start": "Debut de facturation",
        "billing_end": "Fin de facturation",
        "billing_interval": "Intervalle de facturation",
        "year": "Annee",
        "month": "Mois",
        "rates": "Tarifs (CHF/kWh)",
        "local_rate": "Tarif local",
        "bkw_buy_rate": "Tarif achat BKW",
        "bkw_sell_rate": "Tarif vente BKW",
        "members": "Membres",
        "host": "Hote",
        "member": "Membre",
        "first_name": "Prenom",
        "last_name": "Nom de famille",
        "street": "Rue",
        "zip": "NPA",
        "city": "Ville",
        "canton": "Canton",
        "is_host": "Est hote",
        "meters": "Compteurs",
        "external_id": "ID externe",
        "production": "Production",
        "virtual": "Virtuel",
        "remove_meter": "Supprimer compteur",
        "add_meter": "Ajouter compteur",
        "remove_member": "Supprimer membre",
        "add_member": "Ajouter membre",
        "save_config": "Enregistrer",
        "run_pipeline": "Enregistrer & Créer factures",
        "running_bills": "Enregistrement et création des factures...",
        "config_not_found": "config.toml introuvable. Enregistrez d'abord la configuration.",
        "running_pipeline": "Pipeline en cours...",
        "pipeline_success": "Pipeline termine avec succes.",
        "pipeline_exit_error": "Le pipeline s'est termine avec une erreur. Voir le log ci-dessous.",
        "pipeline_failed": "Echec du pipeline: {error}",
        "saved_to": "Enregistre dans {path}",
        "log_output": "Sortie du log",
        "generated_files": "Fichiers generes",
        "pdf_bills": "Factures PDF",
        "csv_summaries": "Resumes CSV",
        "confirm_delete_member": "Supprimer le membre?",
        "confirm_delete_member_msg": "Etes-vous sur de vouloir supprimer ce membre? Cette action est irreversible.",
        "confirm_delete_meter": "Supprimer le compteur?",
        "confirm_delete_meter_msg": "Etes-vous sur de vouloir supprimer ce compteur? Cette action est irreversible.",
        "yes_delete": "Oui, supprimer",
        "cancel": "Annuler",
        # Placeholders for new members/meters
        "placeholder_first_name": "p.ex. Jean",
        "placeholder_last_name": "p.ex. Dupont",
        "placeholder_street": "p.ex. Rue Principale 12",
        "placeholder_zip": "p.ex. 1000",
        "placeholder_city": "p.ex. Lausanne",
        "placeholder_external_id": "p.ex. CH1022201234500000000000057725",
        "placeholder_meter_name": "p.ex. Consommation Physique",
        # Constraint messages
        "only_one_host": "Un seul hote autorise. Decochez d'abord l'autre hote.",
        "max_meters_host": "L'hote peut avoir maximum 4 compteurs",
        "max_meters_member": "Le membre peut avoir maximum 2 compteurs",
        # Hardcoded meter names
        "meter_consumption_physical": "Consommation Physique",
        "meter_production_physical": "Production Physique",
        "meter_consumption_virtual": "Consommation Virtuelle",
        "meter_production_virtual": "Production Virtuelle",
        "add_consumption_meter": "Ajouter compteur consommation",
        "add_production_meter": "Ajouter compteur production",
        # Billing intervals
        "interval_monthly": "Mensuel",
        "interval_quarterly": "Trimestriel",
        "interval_semi_annual": "Semestriel",
        "interval_annual": "Annuel",
        # Data availability
        "data_availability": "Disponibilité des données",
        "no_data_yet": "Pas encore de données",
        "legend_complete": "■ Complet",
        "legend_partial": "◫ Incomplet",
        "legend_none": "· Manquant",
        "csv_location_hint": "Placer les fichiers CSV d'énergie dans: {path}",
    },
    "it": {
        "page_title": "Calcolatore BKW vZEV",
        "settings": "Impostazioni",
        "csv_directory": "Directory CSV",
        "output_directory": "Directory di output",
        "database_path": "Percorso database",
        "collective": "Collettivo",
        "name": "Nome",
        "language": "Lingua",
        "show_daily_detail": "Mostra dettagli giornalieri nei PDF",
        "billing_start": "Inizio fatturazione",
        "billing_end": "Fine fatturazione",
        "billing_interval": "Intervallo di fatturazione",
        "year": "Anno",
        "month": "Mese",
        "rates": "Tariffe (CHF/kWh)",
        "local_rate": "Tariffa locale",
        "bkw_buy_rate": "Tariffa acquisto BKW",
        "bkw_sell_rate": "Tariffa vendita BKW",
        "members": "Membri",
        "host": "Host",
        "member": "Membro",
        "first_name": "Nome",
        "last_name": "Cognome",
        "street": "Via",
        "zip": "CAP",
        "city": "Citta",
        "canton": "Cantone",
        "is_host": "E host",
        "meters": "Contatori",
        "external_id": "ID esterno",
        "production": "Produzione",
        "virtual": "Virtuale",
        "remove_meter": "Rimuovi contatore",
        "add_meter": "Aggiungi contatore",
        "remove_member": "Rimuovi membro",
        "add_member": "Aggiungi membro",
        "save_config": "Salva",
        "run_pipeline": "Salva & Crea fatture",
        "running_bills": "Salvataggio e creazione fatture...",
        "config_not_found": "config.toml non trovato. Salva prima la configurazione.",
        "running_pipeline": "Pipeline in esecuzione...",
        "pipeline_success": "Pipeline completata con successo.",
        "pipeline_exit_error": "Pipeline terminata con errore. Controlla il log qui sotto.",
        "pipeline_failed": "Pipeline fallita: {error}",
        "saved_to": "Salvato in {path}",
        "log_output": "Output del log",
        "generated_files": "File generati",
        "pdf_bills": "Fatture PDF",
        "csv_summaries": "Riepiloghi CSV",
        "confirm_delete_member": "Eliminare il membro?",
        "confirm_delete_member_msg": "Sei sicuro di voler eliminare questo membro? Questa azione non puo essere annullata.",
        "confirm_delete_meter": "Eliminare il contatore?",
        "confirm_delete_meter_msg": "Sei sicuro di voler eliminare questo contatore? Questa azione non puo essere annullata.",
        "yes_delete": "Si, elimina",
        "cancel": "Annulla",
        # Placeholders for new members/meters
        "placeholder_first_name": "es. Mario",
        "placeholder_last_name": "es. Rossi",
        "placeholder_street": "es. Via Principale 12",
        "placeholder_zip": "es. 6900",
        "placeholder_city": "es. Lugano",
        "placeholder_external_id": "es. CH1022201234500000000000057725",
        "placeholder_meter_name": "es. Consumo Fisico",
        # Constraint messages
        "only_one_host": "Solo un host consentito. Deseleziona prima l'altro host.",
        "max_meters_host": "L'host puo avere massimo 4 contatori",
        "max_meters_member": "Il membro puo avere massimo 2 contatori",
        # Hardcoded meter names
        "meter_consumption_physical": "Consumo Fisico",
        "meter_production_physical": "Produzione Fisica",
        "meter_consumption_virtual": "Consumo Virtuale",
        "meter_production_virtual": "Produzione Virtuale",
        "add_consumption_meter": "Aggiungi contatore consumo",
        "add_production_meter": "Aggiungi contatore produzione",
        # Billing intervals
        "interval_monthly": "Mensile",
        "interval_quarterly": "Trimestrale",
        "interval_semi_annual": "Semestrale",
        "interval_annual": "Annuale",
        # Data availability
        "data_availability": "Disponibilità dati",
        "no_data_yet": "Nessun dato ancora",
        "legend_complete": "■ Completo",
        "legend_partial": "◫ Incompleto",
        "legend_none": "· Mancante",
        "csv_location_hint": "Posizionare i file CSV energetici in: {path}",
    },
}


def get_gui_translations(language: str) -> dict[str, str]:
    """Return the GUI translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _GUI_TRANSLATIONS:
        return _GUI_TRANSLATIONS["en"]
    return _GUI_TRANSLATIONS[lang]
