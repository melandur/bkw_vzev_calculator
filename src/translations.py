"""Translations for PDF bill generation.

Supported languages: en, de, fr, it.
"""

from __future__ import annotations

_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "bill_title": "Energy Bill",
        "file_prefix": "bill",
        "from": "FROM",
        "to": "TO",
        "billing_period": "Billing period",
        "consumption_cost": "Consumption & Cost",
        "description": "Description",
        "cost": "Cost",
        "revenue": "Revenue",
        "local_solar": "Local (Solar)",
        "grid_bkw": "Grid (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenue",
        "sold_locally": "Local (Solar)",
        "exported_to_grid": "Grid (BKW)",
        "total_cost": "Total cost",
        "total_revenue": "Total revenue",
        "net": "Net",
        "saved_with_solar": "Saved with local solar",
        "you_saved": "You saved {amount} {currency}  -  {pct}% of your energy was local solar!",
        "footer": "Generated by BKW vZEV Calculator",
        "daily_consumption_cost": "Daily Consumption & Cost",
        "daily_production_revenue": "Daily Production & Revenue",
        "day": "Day",
        "local_kwh": "Local (Solar) kWh",
        "grid_kwh": "Grid (BKW) kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "local_currency": "Local (Solar)",
        "grid_currency": "Grid (BKW)",
        "subtotal": "Subtotal",
        "per_year": "year",
        # Additional fees
        "additional_fees": "Additional Fees",
        "vat": "VAT",
        "incl_vat": "incl. VAT",
        "grand_total": "Grand Total",
        # Month names
        "month_1": "January",
        "month_2": "February",
        "month_3": "March",
        "month_4": "April",
        "month_5": "May",
        "month_6": "June",
        "month_7": "July",
        "month_8": "August",
        "month_9": "September",
        "month_10": "October",
        "month_11": "November",
        "month_12": "December",
    },
    "de": {
        "bill_title": "Energierechnung",
        "file_prefix": "rechnung",
        "from": "VON",
        "to": "AN",
        "billing_period": "Abrechnungszeitraum",
        "consumption_cost": "Verbrauch & Kosten",
        "description": "Beschreibung",
        "cost": "Kosten",
        "revenue": "Ertrag",
        "local_solar": "Lokal (Solar)",
        "grid_bkw": "Netz (BKW)",
        "total": "Total",
        "production_revenue": "Produktion & Ertrag",
        "sold_locally": "Lokal (Solar)",
        "exported_to_grid": "Netz (BKW)",
        "total_cost": "Gesamtkosten",
        "total_revenue": "Gesamtertrag",
        "net": "Netto",
        "saved_with_solar": "Ersparnis mit Solarstrom",
        "you_saved": "Sie sparten {amount} {currency}  -  {pct}% Ihres Stroms war lokaler Solarstrom!",
        "footer": "Erstellt mit BKW vZEV Rechner",
        "daily_consumption_cost": "Tagesverbrauch & Kosten",
        "daily_production_revenue": "Verkaufter Solarstrom & Ertrag",
        "day": "Tag",
        "local_kwh": "Lokal (Solar) kWh",
        "grid_kwh": "Netz (BKW) kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Verkaufter Solarstrom kWh",
        "local_currency": "Lokal (Solar)",
        "grid_currency": "Netz (BKW)",
        "subtotal": "Zwischentotal",
        "per_year": "Jahr",
        # Additional fees
        "additional_fees": "Zusatzgebühren",
        "vat": "MwSt.",
        "incl_vat": "inkl. MwSt.",
        "grand_total": "Gesamtbetrag",
        "month_1": "Januar",
        "month_2": "Februar",
        "month_3": "März",
        "month_4": "April",
        "month_5": "Mai",
        "month_6": "Juni",
        "month_7": "Juli",
        "month_8": "August",
        "month_9": "September",
        "month_10": "Oktober",
        "month_11": "November",
        "month_12": "Dezember",
    },
    "fr": {
        "bill_title": "Facture d'énergie",
        "file_prefix": "facture",
        "from": "DE",
        "to": "À",
        "billing_period": "Période de facturation",
        "consumption_cost": "Consommation & Coûts",
        "description": "Description",
        "cost": "Coûts",
        "revenue": "Revenus",
        "local_solar": "Local (Solaire)",
        "grid_bkw": "Réseau (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenus",
        "sold_locally": "Local (Solaire)",
        "exported_to_grid": "Réseau (BKW)",
        "total_cost": "Coût total",
        "total_revenue": "Revenu total",
        "net": "Net",
        "saved_with_solar": "Économisé avec le solaire",
        "you_saved": "Vous avez économisé {amount} {currency}  -  {pct}% de votre énergie était du solaire local!",
        "footer": "Généré par BKW vZEV Calculateur",
        "daily_consumption_cost": "Consommation & Coûts journaliers",
        "daily_production_revenue": "Production & Revenus journaliers",
        "day": "Jour",
        "local_kwh": "Local (Solaire) kWh",
        "grid_kwh": "Réseau (BKW) kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "local_currency": "Local (Solaire)",
        "grid_currency": "Réseau (BKW)",
        "subtotal": "Sous-total",
        "per_year": "an",
        # Additional fees
        "additional_fees": "Frais supplémentaires",
        "vat": "TVA",
        "incl_vat": "TVA incl.",
        "grand_total": "Total général",
        "month_1": "Janvier",
        "month_2": "Février",
        "month_3": "Mars",
        "month_4": "Avril",
        "month_5": "Mai",
        "month_6": "Juin",
        "month_7": "Juillet",
        "month_8": "Août",
        "month_9": "Septembre",
        "month_10": "Octobre",
        "month_11": "Novembre",
        "month_12": "Décembre",
    },
    "it": {
        "bill_title": "Fattura energetica",
        "file_prefix": "fattura",
        "from": "DA",
        "to": "A",
        "billing_period": "Periodo di fatturazione",
        "consumption_cost": "Consumo & Costi",
        "description": "Descrizione",
        "cost": "Costi",
        "revenue": "Ricavi",
        "local_solar": "Locale (Solare)",
        "grid_bkw": "Rete (BKW)",
        "total": "Totale",
        "production_revenue": "Produzione & Ricavi",
        "sold_locally": "Locale (Solare)",
        "exported_to_grid": "Rete (BKW)",
        "total_cost": "Costo totale",
        "total_revenue": "Ricavo totale",
        "net": "Netto",
        "saved_with_solar": "Risparmio con il solare",
        "you_saved": "Hai risparmiato {amount} {currency}  -  {pct}% della tua energia era solare locale!",
        "footer": "Generato da BKW vZEV Calcolatore",
        "daily_consumption_cost": "Consumo & Costi giornalieri",
        "daily_production_revenue": "Produzione & Ricavi giornalieri",
        "day": "Giorno",
        "local_kwh": "Locale (Solare) kWh",
        "grid_kwh": "Rete (BKW) kWh",
        "total_kwh": "Totale kWh",
        "prod_kwh": "Prod. kWh",
        "local_currency": "Locale (Solare)",
        "grid_currency": "Rete (BKW)",
        "subtotal": "Subtotale",
        "per_year": "anno",
        # Additional fees
        "additional_fees": "Costi aggiuntivi",
        "vat": "IVA",
        "incl_vat": "IVA incl.",
        "grand_total": "Totale complessivo",
        "month_1": "Gennaio",
        "month_2": "Febbraio",
        "month_3": "Marzo",
        "month_4": "Aprile",
        "month_5": "Maggio",
        "month_6": "Giugno",
        "month_7": "Luglio",
        "month_8": "Agosto",
        "month_9": "Settembre",
        "month_10": "Ottobre",
        "month_11": "Novembre",
        "month_12": "Dicembre",
    },
}


def get_translations(language: str) -> dict[str, str]:
    """Return the translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _TRANSLATIONS:
        return _TRANSLATIONS["en"]
    return _TRANSLATIONS[lang]


def get_month_name(language: str, month: int) -> str:
    """Return the localised month name (1-12)."""
    t = get_translations(language)
    return t.get(f"month_{month}", f"Month {month}")


# ===========================================================================
# GUI translations (Streamlit app)
# ===========================================================================

_GUI_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "page_title": "BKW vZEV Calculator",
        "settings": "Settings",
        "csv_directory": "CSV directory",
        "csv_directory_help": "Drop your energy CSV files from BKW here",
        "output_directory": "Output directory",
        "output_directory_help": "Generated bills (PDFs and CSVs) will be saved here",
        "database_path": "Database path",
        "database_path_help": "Technical storage file - if you don't know what a database is, no need to worry",
        "collective": "Collective",
        "name": "Name",
        "language": "Language",
        "show_daily_detail": "Show daily detail in PDFs",
        "show_icons": "Show icons in PDFs",
        "customize_labels": "Customize bill labels",
        "customize_labels_help": "Override the default texts used in PDF bills",
        "reset_defaults": "Reset to defaults",
        "label_group_header": "Header",
        "label_group_tables": "Tables",
        "label_group_summary": "Summary",
        "label_group_daily": "Daily details",
        "label_group_fees": "Fees & VAT",
        "label_group_other": "Other",
        "bill": "Bill",
        "billing_start": "Billing start",
        "billing_end": "Billing end",
        "billing_interval": "Billing interval",
        "year": "Year",
        "month": "Month",
        "rates": "Rates",
        "local_rate": "Local rate (CHF/kWh)",
        "bkw_buy_rate": "BKW buy rate (CHF/kWh)",
        "bkw_sell_rate": "BKW sell rate (CHF/kWh)",
        "vat_rate": "VAT (%)",
        "vat_rate_help": "Applied to positive net amounts",
        "vat_on_grid": "Grid (BKW)",
        "vat_on_local": "Local (Solar)",
        "vat_on_fees": "Additional fees",
        "vat_applies_to": "VAT applies to:",
        "local_rate_help": "Price members pay for local solar energy, and what producers earn when selling to other members",
        "bkw_buy_rate_help": "Grid purchase rate including all fees and VAT from your BKW invoice",
        "bkw_sell_rate_help": "Grid export rate (energy + certificates of origin)",
        "billing_start_help": "First month to include in billing period",
        "billing_end_help": "Last month to include in billing period",
        "billing_interval_help": "How often bills are generated: monthly, quarterly, semi-annual, or annual",
        "show_daily_detail_help": "Include detailed daily breakdown pages in PDF bills",
        "is_host_help": "The host owns the grid connection and has 4 meters (physical + virtual, consumption + production)",
        "is_production_help": "Mark as production meter if it measures solar/renewable energy generation",
        "is_virtual_help": "Virtual meters measure at the grid connection point (only for host)",
        "external_id_help": "Meter ID as shown in BKW CSV files (Messpunkt column)",
        "custom_fees_help": "Additional fees or charges applied to this member's bill",
        "members": "Members",
        "host": "Host",
        "member": "Member",
        "first_name": "First name",
        "last_name": "Last name",
        "street": "Street",
        "zip": "ZIP",
        "city": "City",
        "canton": "Canton",
        "is_host": "Is host",
        "meters": "Meters",
        "external_id": "External ID",
        "production": "Production",
        "virtual": "Virtual",
        "remove_meter": "Remove meter",
        "add_meter": "Add meter",
        "remove_member": "Remove member",
        "add_member": "Add member",
        "save_config": "Save",
        "run_pipeline": "Save & Create Bills",
        "running_bills": "Saving and creating bills...",
        "config_not_found": "config.toml not found. Save the config first.",
        "running_pipeline": "Running pipeline...",
        "pipeline_success": "Pipeline completed successfully.",
        "pipeline_exit_error": "Pipeline exited with an error. Check the log below.",
        "pipeline_failed": "Pipeline failed: {error}",
        "saved_to": "Saved to {path}",
        "log_output": "Log output",
        "generated_files": "Generated files",
        "pdf_bills": "PDF bills",
        "csv_summaries": "CSV summaries",
        "confirm_delete_member": "Delete member?",
        "confirm_delete_member_msg": "Are you sure you want to delete this member? This action cannot be undone.",
        "confirm_delete_meter": "Delete meter?",
        "confirm_delete_meter_msg": "Are you sure you want to delete this meter? This action cannot be undone.",
        "yes_delete": "Yes, delete",
        "cancel": "Cancel",
        # Placeholders for new members/meters
        "placeholder_first_name": "e.g. John",
        "placeholder_last_name": "e.g. Smith",
        "placeholder_street": "e.g. Main Street 12",
        "placeholder_zip": "e.g. 3000",
        "placeholder_city": "e.g. Bern",
        "placeholder_external_id": "e.g. CH1022201234500000000000057725",
        "placeholder_meter_name": "e.g. Consumption Physical",
        # Constraint messages
        "only_one_host": "Only one host allowed. Uncheck the other host first.",
        "max_meters_host": "Host can have maximum 4 meters",
        "max_meters_member": "Member can have maximum 2 meters",
        # Hardcoded meter names
        "meter_consumption_physical": "Consumption Physical",
        "meter_production_physical": "Production Physical",
        "meter_consumption_virtual": "Consumption Virtual",
        "meter_production_virtual": "Production Virtual",
        "add_consumption_meter": "Add consumption meter",
        # Data availability
        "data_availability": "Data Availability",
        "no_data_yet": "No data yet",
        "legend_complete": "■ Complete",
        "legend_partial": "◫ Not complete",
        "legend_none": "· Missing",
        "csv_location_hint": "Place energy CSV files in: {path}",
        "add_production_meter": "Add production meter",
        # Billing intervals
        "interval_monthly": "Monthly",
        "interval_quarterly": "Quarterly",
        "interval_semi_annual": "Semi-annual",
        "interval_annual": "Annual",
        # Custom fees
        "custom_fees": "Custom Fees",
        "add_fee": "Add fee",
        "remove_fee": "Remove",
        "fee_name": "Fee name",
        "fee_value": "Value",
        "fee_type": "Type",
        "fee_type_percent": "Percent (%)",
        "fee_type_yearly": "Yearly (CHF)",
        "fee_type_per_kwh": "Per kWh (CHF/kWh)",
        "fee_unit_yearly": "CHF / year",
        "fee_unit_per_kwh": "CHF / kWh",
        "fee_basis": "Basis",
        "fee_basis_grid": "Grid (BKW)",
        "fee_basis_local": "Local (Solar)",
        "drag_to_reorder": "Drag to reorder",
        "copy_to_all": "Copy to all members",
        "no_fees_yet": "No custom fees defined yet",
        "select_member": "Select member",
    },
    "de": {
        "page_title": "BKW vZEV Rechner",
        "settings": "Einstellungen",
        "csv_directory": "CSV-Verzeichnis",
        "csv_directory_help": "Hier legen Sie Ihre Energie-CSV-Dateien von BKW ab",
        "output_directory": "Ausgabeverzeichnis",
        "output_directory_help": "Hier werden die generierten Rechnungen (PDFs und CSVs) gespeichert",
        "database_path": "Datenbankpfad",
        "database_path_help": "Technische Speicherdatei - falls Sie nicht wissen, was eine Datenbank ist, kein Grund zur Sorge",
        "collective": "Gemeinschaft",
        "name": "Name",
        "language": "Sprache",
        "show_daily_detail": "Tagesdetails in PDFs anzeigen",
        "show_icons": "Icons in PDFs anzeigen",
        "customize_labels": "Rechnungstexte anpassen",
        "customize_labels_help": "Standardtexte in PDF-Rechnungen überschreiben",
        "reset_defaults": "Auf Standard zurücksetzen",
        "label_group_header": "Kopfzeile",
        "label_group_tables": "Tabellen",
        "label_group_summary": "Zusammenfassung",
        "label_group_daily": "Tagesdetails",
        "label_group_fees": "Gebühren & MwSt",
        "label_group_other": "Sonstiges",
        "bill": "Rechnung",
        "billing_start": "Abrechnungsbeginn",
        "billing_end": "Abrechnungsende",
        "billing_interval": "Abrechnungsintervall",
        "year": "Jahr",
        "month": "Monat",
        "rates": "Tarife",
        "local_rate": "Lokaltarif (CHF/kWh)",
        "bkw_buy_rate": "BKW Bezugstarif (CHF/kWh)",
        "bkw_sell_rate": "BKW Einspeisevergütung (CHF/kWh)",
        "vat_rate": "Mehrwertsteuer (%)",
        "vat_rate_help": "Wird auf positive Nettobeträge angewendet",
        "vat_on_grid": "Netz (BKW)",
        "vat_on_local": "Lokal (Solar)",
        "vat_on_fees": "Zusatzgebühren",
        "vat_applies_to": "MwSt. gilt für:",
        "local_rate_help": "Preis, den Mitglieder für lokalen Solarstrom zahlen, und was Produzenten beim Verkauf an andere Mitglieder verdienen",
        "bkw_buy_rate_help": "Netzbezugstarif inkl. aller Gebühren und MWST aus Ihrer BKW-Rechnung",
        "bkw_sell_rate_help": "Netzeinspeisevergütung (Energie + Herkunftsnachweise)",
        "billing_start_help": "Erster Monat der Abrechnungsperiode",
        "billing_end_help": "Letzter Monat der Abrechnungsperiode",
        "billing_interval_help": "Wie oft Rechnungen erstellt werden: monatlich, vierteljährlich, halbjährlich oder jährlich",
        "show_daily_detail_help": "Detaillierte Tagesaufstellung in PDF-Rechnungen einbeziehen",
        "is_host_help": "Der Gastgeber besitzt den Netzanschluss und hat 4 Zähler (physisch + virtuell, Verbrauch + Produktion)",
        "is_production_help": "Als Produktionszähler markieren, wenn er Solar-/Erneuerbare Energie misst",
        "is_virtual_help": "Virtuelle Zähler messen am Netzanschlusspunkt (nur für Gastgeber)",
        "external_id_help": "Zähler-ID wie in BKW-CSV-Dateien angezeigt (Spalte Messpunkt)",
        "custom_fees_help": "Zusätzliche Gebühren oder Abgaben für dieses Mitglied",
        "members": "Mitglieder",
        "host": "Gastgeber",
        "member": "Mitglied",
        "first_name": "Vorname",
        "last_name": "Nachname",
        "street": "Strasse",
        "zip": "PLZ",
        "city": "Ort",
        "canton": "Kanton",
        "is_host": "Ist Gastgeber",
        "meters": "Zähler",
        "external_id": "Externe ID",
        "production": "Produktion",
        "virtual": "Virtuell",
        "remove_meter": "Zähler entfernen",
        "add_meter": "Zähler hinzufügen",
        "remove_member": "Mitglied entfernen",
        "add_member": "Mitglied hinzufügen",
        "save_config": "Speichern",
        "run_pipeline": "Speichern & Rechnungen erstellen",
        "running_bills": "Speichern und Rechnungen erstellen...",
        "config_not_found": "config.toml nicht gefunden. Speichern Sie zuerst die Konfiguration.",
        "running_pipeline": "Pipeline wird ausgeführt...",
        "pipeline_success": "Pipeline erfolgreich abgeschlossen.",
        "pipeline_exit_error": "Pipeline mit Fehler beendet. Siehe Log unten.",
        "pipeline_failed": "Pipeline fehlgeschlagen: {error}",
        "saved_to": "Gespeichert in {path}",
        "log_output": "Log-Ausgabe",
        "generated_files": "Generierte Dateien",
        "pdf_bills": "PDF-Rechnungen",
        "csv_summaries": "CSV-Zusammenfassungen",
        "confirm_delete_member": "Mitglied löschen?",
        "confirm_delete_member_msg": "Sind Sie sicher, dass Sie dieses Mitglied löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.",
        "confirm_delete_meter": "Zähler löschen?",
        "confirm_delete_meter_msg": "Sind Sie sicher, dass Sie diesen Zähler löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.",
        "yes_delete": "Ja, löschen",
        "cancel": "Abbrechen",
        # Placeholders for new members/meters
        "placeholder_first_name": "z.B. Max",
        "placeholder_last_name": "z.B. Müller",
        "placeholder_street": "z.B. Hauptstrasse 12",
        "placeholder_zip": "z.B. 3000",
        "placeholder_city": "z.B. Bern",
        "placeholder_external_id": "z.B. CH1022201234500000000000057725",
        "placeholder_meter_name": "z.B. Verbrauch Physisch",
        # Constraint messages
        "only_one_host": "Nur ein Gastgeber erlaubt. Deaktivieren Sie zuerst den anderen Gastgeber.",
        "max_meters_host": "Gastgeber kann maximal 4 Zähler haben",
        "max_meters_member": "Mitglied kann maximal 2 Zähler haben",
        # Hardcoded meter names
        "meter_consumption_physical": "Verbrauch Physisch",
        "meter_production_physical": "Produktion Physisch",
        "meter_consumption_virtual": "Verbrauch Virtuell",
        "meter_production_virtual": "Produktion Virtuell",
        "add_consumption_meter": "Verbrauchszähler hinzufügen",
        "add_production_meter": "Produktionszähler hinzufügen",
        # Billing intervals
        "interval_monthly": "Monatlich",
        "interval_quarterly": "Quartalsweise",
        "interval_semi_annual": "Halbjährlich",
        "interval_annual": "Jährlich",
        # Custom fees
        "custom_fees": "Zusatzgebühren",
        "add_fee": "Gebühr hinzufügen",
        "remove_fee": "Entfernen",
        "fee_name": "Gebührenname",
        "fee_value": "Wert",
        "fee_type": "Typ",
        "fee_type_percent": "Prozent (%)",
        "fee_type_yearly": "Jährlich (CHF)",
        "fee_type_per_kwh": "Pro kWh (CHF/kWh)",
        "fee_unit_yearly": "CHF / Jahr",
        "fee_unit_per_kwh": "CHF / kWh",
        "fee_basis": "Basis",
        "fee_basis_grid": "Netz (BKW)",
        "fee_basis_local": "Lokal (Solar)",
        "drag_to_reorder": "Ziehen zum Sortieren",
        "copy_to_all": "Auf alle kopieren",
        "no_fees_yet": "Noch keine Zusatzgebühren definiert",
        "select_member": "Mitglied auswählen",
        # Data availability
        "data_availability": "Datenverfügbarkeit",
        "no_data_yet": "Noch keine Daten",
        "legend_complete": "■ Vollständig",
        "legend_partial": "◫ Unvollständig",
        "legend_none": "· Fehlt",
        "csv_location_hint": "Energie-CSV-Dateien ablegen in: {path}",
    },
    "fr": {
        "page_title": "Calculateur BKW vZEV",
        "settings": "Parametres",
        "csv_directory": "Repertoire CSV",
        "csv_directory_help": "Deposez vos fichiers CSV d'energie de BKW ici",
        "output_directory": "Repertoire de sortie",
        "output_directory_help": "Les factures generees (PDFs et CSVs) seront enregistrees ici",
        "database_path": "Chemin base de donnees",
        "database_path_help": "Fichier de stockage technique - si vous ne savez pas ce qu'est une base de donnees, pas de souci",
        "collective": "Collectif",
        "name": "Nom",
        "language": "Langue",
        "show_daily_detail": "Afficher details journaliers dans les PDFs",
        "show_icons": "Afficher icônes dans les PDFs",
        "customize_labels": "Personnaliser les textes",
        "customize_labels_help": "Modifier les textes par défaut des factures PDF",
        "reset_defaults": "Réinitialiser par défaut",
        "label_group_header": "En-tête",
        "label_group_tables": "Tableaux",
        "label_group_summary": "Résumé",
        "label_group_daily": "Détails journaliers",
        "label_group_fees": "Frais & TVA",
        "label_group_other": "Autre",
        "bill": "Facture",
        "billing_start": "Debut de facturation",
        "billing_end": "Fin de facturation",
        "billing_interval": "Intervalle de facturation",
        "year": "Annee",
        "month": "Mois",
        "rates": "Tarifs",
        "local_rate": "Tarif local (CHF/kWh)",
        "bkw_buy_rate": "Tarif achat BKW (CHF/kWh)",
        "bkw_sell_rate": "Tarif vente BKW (CHF/kWh)",
        "vat_rate": "TVA (%)",
        "vat_rate_help": "Appliqué aux montants nets positifs",
        "vat_on_grid": "Réseau (BKW)",
        "vat_on_local": "Local (Solaire)",
        "vat_on_fees": "Frais supplémentaires",
        "vat_applies_to": "TVA s'applique à :",
        "local_rate_help": "Prix que les membres paient pour l'énergie solaire locale, et ce que les producteurs gagnent en vendant à d'autres membres",
        "bkw_buy_rate_help": "Tarif d'achat réseau incluant tous les frais et TVA de votre facture BKW",
        "bkw_sell_rate_help": "Tarif d'injection réseau (énergie + certificats d'origine)",
        "billing_start_help": "Premier mois à inclure dans la période de facturation",
        "billing_end_help": "Dernier mois à inclure dans la période de facturation",
        "billing_interval_help": "Fréquence de génération des factures: mensuelle, trimestrielle, semestrielle ou annuelle",
        "show_daily_detail_help": "Inclure des pages détaillées quotidiennes dans les factures PDF",
        "is_host_help": "L'hôte possède le raccordement réseau et a 4 compteurs (physique + virtuel, consommation + production)",
        "is_production_help": "Marquer comme compteur de production s'il mesure la génération d'énergie solaire/renouvelable",
        "is_virtual_help": "Les compteurs virtuels mesurent au point de raccordement réseau (uniquement pour l'hôte)",
        "external_id_help": "ID du compteur tel qu'affiché dans les fichiers CSV BKW (colonne Messpunkt)",
        "custom_fees_help": "Frais ou charges supplémentaires appliqués à la facture de ce membre",
        "members": "Membres",
        "host": "Hote",
        "member": "Membre",
        "first_name": "Prenom",
        "last_name": "Nom de famille",
        "street": "Rue",
        "zip": "NPA",
        "city": "Ville",
        "canton": "Canton",
        "is_host": "Est hote",
        "meters": "Compteurs",
        "external_id": "ID externe",
        "production": "Production",
        "virtual": "Virtuel",
        "remove_meter": "Supprimer compteur",
        "add_meter": "Ajouter compteur",
        "remove_member": "Supprimer membre",
        "add_member": "Ajouter membre",
        "save_config": "Enregistrer",
        "run_pipeline": "Enregistrer & Créer factures",
        "running_bills": "Enregistrement et création des factures...",
        "config_not_found": "config.toml introuvable. Enregistrez d'abord la configuration.",
        "running_pipeline": "Pipeline en cours...",
        "pipeline_success": "Pipeline termine avec succes.",
        "pipeline_exit_error": "Le pipeline s'est termine avec une erreur. Voir le log ci-dessous.",
        "pipeline_failed": "Echec du pipeline: {error}",
        "saved_to": "Enregistre dans {path}",
        "log_output": "Sortie du log",
        "generated_files": "Fichiers generes",
        "pdf_bills": "Factures PDF",
        "csv_summaries": "Resumes CSV",
        "confirm_delete_member": "Supprimer le membre?",
        "confirm_delete_member_msg": "Etes-vous sur de vouloir supprimer ce membre? Cette action est irreversible.",
        "confirm_delete_meter": "Supprimer le compteur?",
        "confirm_delete_meter_msg": "Etes-vous sur de vouloir supprimer ce compteur? Cette action est irreversible.",
        "yes_delete": "Oui, supprimer",
        "cancel": "Annuler",
        # Placeholders for new members/meters
        "placeholder_first_name": "p.ex. Jean",
        "placeholder_last_name": "p.ex. Dupont",
        "placeholder_street": "p.ex. Rue Principale 12",
        "placeholder_zip": "p.ex. 1000",
        "placeholder_city": "p.ex. Lausanne",
        "placeholder_external_id": "p.ex. CH1022201234500000000000057725",
        "placeholder_meter_name": "p.ex. Consommation Physique",
        # Constraint messages
        "only_one_host": "Un seul hote autorise. Decochez d'abord l'autre hote.",
        "max_meters_host": "L'hote peut avoir maximum 4 compteurs",
        "max_meters_member": "Le membre peut avoir maximum 2 compteurs",
        # Hardcoded meter names
        "meter_consumption_physical": "Consommation Physique",
        "meter_production_physical": "Production Physique",
        "meter_consumption_virtual": "Consommation Virtuelle",
        "meter_production_virtual": "Production Virtuelle",
        "add_consumption_meter": "Ajouter compteur consommation",
        "add_production_meter": "Ajouter compteur production",
        # Billing intervals
        "interval_monthly": "Mensuel",
        "interval_quarterly": "Trimestriel",
        "interval_semi_annual": "Semestriel",
        "interval_annual": "Annuel",
        # Custom fees
        "custom_fees": "Frais supplémentaires",
        "add_fee": "Ajouter frais",
        "remove_fee": "Supprimer",
        "fee_name": "Nom du frais",
        "fee_value": "Valeur",
        "fee_type": "Type",
        "fee_type_percent": "Pourcentage (%)",
        "fee_type_yearly": "Annuel (CHF)",
        "fee_type_per_kwh": "Par kWh (CHF/kWh)",
        "fee_unit_yearly": "CHF / an",
        "fee_unit_per_kwh": "CHF / kWh",
        "fee_basis": "Base",
        "fee_basis_grid": "Réseau (BKW)",
        "fee_basis_local": "Local (Solaire)",
        "drag_to_reorder": "Glisser pour réorganiser",
        "copy_to_all": "Copier à tous",
        "no_fees_yet": "Aucun frais supplémentaire défini",
        "select_member": "Sélectionner membre",
        # Data availability
        "data_availability": "Disponibilité des données",
        "no_data_yet": "Pas encore de données",
        "legend_complete": "■ Complet",
        "legend_partial": "◫ Incomplet",
        "legend_none": "· Manquant",
        "csv_location_hint": "Placer les fichiers CSV d'énergie dans: {path}",
    },
    "it": {
        "page_title": "Calcolatore BKW vZEV",
        "settings": "Impostazioni",
        "csv_directory": "Directory CSV",
        "csv_directory_help": "Deposita qui i tuoi file CSV di energia da BKW",
        "output_directory": "Directory di output",
        "output_directory_help": "Le fatture generate (PDF e CSV) verranno salvate qui",
        "database_path": "Percorso database",
        "database_path_help": "File di archiviazione tecnico - se non sai cos'e un database, non preoccuparti",
        "collective": "Collettivo",
        "name": "Nome",
        "language": "Lingua",
        "show_daily_detail": "Mostra dettagli giornalieri nei PDF",
        "show_icons": "Mostra icone nei PDF",
        "customize_labels": "Personalizza testi fattura",
        "customize_labels_help": "Sostituisci i testi predefiniti nelle fatture PDF",
        "reset_defaults": "Ripristina predefiniti",
        "label_group_header": "Intestazione",
        "label_group_tables": "Tabelle",
        "label_group_summary": "Riepilogo",
        "label_group_daily": "Dettagli giornalieri",
        "label_group_fees": "Costi & IVA",
        "label_group_other": "Altro",
        "bill": "Fattura",
        "billing_start": "Inizio fatturazione",
        "billing_end": "Fine fatturazione",
        "billing_interval": "Intervallo di fatturazione",
        "year": "Anno",
        "month": "Mese",
        "rates": "Tariffe",
        "local_rate": "Tariffa locale (CHF/kWh)",
        "bkw_buy_rate": "Tariffa acquisto BKW (CHF/kWh)",
        "bkw_sell_rate": "Tariffa vendita BKW (CHF/kWh)",
        "vat_rate": "IVA (%)",
        "vat_rate_help": "Applicato agli importi netti positivi",
        "vat_on_grid": "Rete (BKW)",
        "vat_on_local": "Locale (Solare)",
        "vat_on_fees": "Costi aggiuntivi",
        "vat_applies_to": "IVA si applica a:",
        "local_rate_help": "Prezzo che i membri pagano per l'energia solare locale, e ciò che i produttori guadagnano vendendo ad altri membri",
        "bkw_buy_rate_help": "Tariffa di acquisto dalla rete inclusi tutti i costi e IVA dalla vostra fattura BKW",
        "bkw_sell_rate_help": "Tariffa di immissione in rete (energia + certificati di origine)",
        "billing_start_help": "Primo mese da includere nel periodo di fatturazione",
        "billing_end_help": "Ultimo mese da includere nel periodo di fatturazione",
        "billing_interval_help": "Frequenza di generazione delle fatture: mensile, trimestrale, semestrale o annuale",
        "show_daily_detail_help": "Includere pagine dettagliate giornaliere nelle fatture PDF",
        "is_host_help": "L'host possiede il collegamento alla rete e ha 4 contatori (fisico + virtuale, consumo + produzione)",
        "is_production_help": "Contrassegna come contatore di produzione se misura la generazione di energia solare/rinnovabile",
        "is_virtual_help": "I contatori virtuali misurano al punto di collegamento alla rete (solo per l'host)",
        "external_id_help": "ID del contatore come mostrato nei file CSV BKW (colonna Messpunkt)",
        "custom_fees_help": "Costi o spese aggiuntive applicate alla fattura di questo membro",
        "members": "Membri",
        "host": "Host",
        "member": "Membro",
        "first_name": "Nome",
        "last_name": "Cognome",
        "street": "Via",
        "zip": "CAP",
        "city": "Citta",
        "canton": "Cantone",
        "is_host": "E host",
        "meters": "Contatori",
        "external_id": "ID esterno",
        "production": "Produzione",
        "virtual": "Virtuale",
        "remove_meter": "Rimuovi contatore",
        "add_meter": "Aggiungi contatore",
        "remove_member": "Rimuovi membro",
        "add_member": "Aggiungi membro",
        "save_config": "Salva",
        "run_pipeline": "Salva & Crea fatture",
        "running_bills": "Salvataggio e creazione fatture...",
        "config_not_found": "config.toml non trovato. Salva prima la configurazione.",
        "running_pipeline": "Pipeline in esecuzione...",
        "pipeline_success": "Pipeline completata con successo.",
        "pipeline_exit_error": "Pipeline terminata con errore. Controlla il log qui sotto.",
        "pipeline_failed": "Pipeline fallita: {error}",
        "saved_to": "Salvato in {path}",
        "log_output": "Output del log",
        "generated_files": "File generati",
        "pdf_bills": "Fatture PDF",
        "csv_summaries": "Riepiloghi CSV",
        "confirm_delete_member": "Eliminare il membro?",
        "confirm_delete_member_msg": "Sei sicuro di voler eliminare questo membro? Questa azione non puo essere annullata.",
        "confirm_delete_meter": "Eliminare il contatore?",
        "confirm_delete_meter_msg": "Sei sicuro di voler eliminare questo contatore? Questa azione non puo essere annullata.",
        "yes_delete": "Si, elimina",
        "cancel": "Annulla",
        # Placeholders for new members/meters
        "placeholder_first_name": "es. Mario",
        "placeholder_last_name": "es. Rossi",
        "placeholder_street": "es. Via Principale 12",
        "placeholder_zip": "es. 6900",
        "placeholder_city": "es. Lugano",
        "placeholder_external_id": "es. CH1022201234500000000000057725",
        "placeholder_meter_name": "es. Consumo Fisico",
        # Constraint messages
        "only_one_host": "Solo un host consentito. Deseleziona prima l'altro host.",
        "max_meters_host": "L'host puo avere massimo 4 contatori",
        "max_meters_member": "Il membro puo avere massimo 2 contatori",
        # Hardcoded meter names
        "meter_consumption_physical": "Consumo Fisico",
        "meter_production_physical": "Produzione Fisica",
        "meter_consumption_virtual": "Consumo Virtuale",
        "meter_production_virtual": "Produzione Virtuale",
        "add_consumption_meter": "Aggiungi contatore consumo",
        "add_production_meter": "Aggiungi contatore produzione",
        # Billing intervals
        "interval_monthly": "Mensile",
        "interval_quarterly": "Trimestrale",
        "interval_semi_annual": "Semestrale",
        "interval_annual": "Annuale",
        # Custom fees
        "custom_fees": "Costi aggiuntivi",
        "add_fee": "Aggiungi costo",
        "remove_fee": "Rimuovi",
        "fee_name": "Nome costo",
        "fee_value": "Valore",
        "fee_type": "Tipo",
        "fee_type_percent": "Percentuale (%)",
        "fee_type_yearly": "Annuale (CHF)",
        "fee_type_per_kwh": "Per kWh (CHF/kWh)",
        "fee_unit_yearly": "CHF / anno",
        "fee_unit_per_kwh": "CHF / kWh",
        "fee_basis": "Base",
        "fee_basis_grid": "Rete (BKW)",
        "fee_basis_local": "Locale (Solare)",
        "drag_to_reorder": "Trascina per riordinare",
        "copy_to_all": "Copia a tutti",
        "no_fees_yet": "Nessun costo aggiuntivo definito",
        "select_member": "Seleziona membro",
        # Data availability
        "data_availability": "Disponibilità dati",
        "no_data_yet": "Nessun dato ancora",
        "legend_complete": "■ Completo",
        "legend_partial": "◫ Incompleto",
        "legend_none": "· Mancante",
        "csv_location_hint": "Posizionare i file CSV energetici in: {path}",
    },
}


def get_gui_translations(language: str) -> dict[str, str]:
    """Return the GUI translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _GUI_TRANSLATIONS:
        return _GUI_TRANSLATIONS["en"]
    return _GUI_TRANSLATIONS[lang]
