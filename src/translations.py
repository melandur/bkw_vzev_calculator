"""Translations for PDF bill generation.

Supported languages: en, de, fr, it.
"""

from __future__ import annotations

_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "bill_title": "Energy Bill",
        "file_prefix": "bill",
        "from": "FROM",
        "to": "TO",
        "billing_period": "Billing period",
        "consumption_cost": "Consumption & Cost",
        "description": "Description",
        "cost": "Cost",
        "revenue": "Revenue",
        "local_solar": "Local solar",
        "grid_bkw": "Grid (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenue",
        "sold_locally": "Sold locally",
        "exported_to_grid": "Exported to grid",
        "total_cost": "Total cost",
        "total_revenue": "Total revenue",
        "net": "Net",
        "saved_with_solar": "Saved with local solar",
        "you_saved": "You saved {amount} {currency}  -  {pct}% of your energy was local solar!",
        "footer": "Generated by BKW vZEV Calculator",
        "daily_consumption_cost": "Daily Consumption & Cost",
        "daily_production_revenue": "Daily Production & Revenue",
        "day": "Day",
        "local_kwh": "Local kWh",
        "grid_kwh": "Grid kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        # Month names
        "month_1": "January",
        "month_2": "February",
        "month_3": "March",
        "month_4": "April",
        "month_5": "May",
        "month_6": "June",
        "month_7": "July",
        "month_8": "August",
        "month_9": "September",
        "month_10": "October",
        "month_11": "November",
        "month_12": "December",
    },
    "de": {
        "bill_title": "Energierechnung",
        "file_prefix": "rechnung",
        "from": "VON",
        "to": "AN",
        "billing_period": "Abrechnungszeitraum",
        "consumption_cost": "Verbrauch & Kosten",
        "description": "Beschreibung",
        "cost": "Kosten",
        "revenue": "Ertrag",
        "local_solar": "Lokal Solar",
        "grid_bkw": "Netz (BKW)",
        "total": "Total",
        "production_revenue": "Produktion & Ertrag",
        "sold_locally": "Lokal verkauft",
        "exported_to_grid": "Ins Netz eingespeist",
        "total_cost": "Gesamtkosten",
        "total_revenue": "Gesamtertrag",
        "net": "Netto",
        "saved_with_solar": "Ersparnis mit Solarstrom",
        "you_saved": "Sie sparten {amount} {currency}  -  {pct}% Ihres Stroms war lokaler Solarstrom!",
        "footer": "Erstellt mit BKW vZEV Calculator",
        "daily_consumption_cost": "Tagesverbrauch & Kosten",
        "daily_production_revenue": "Tagesproduktion & Ertrag",
        "day": "Tag",
        "local_kwh": "Lokal kWh",
        "grid_kwh": "Netz kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "month_1": "Januar",
        "month_2": "Februar",
        "month_3": "Maerz",
        "month_4": "April",
        "month_5": "Mai",
        "month_6": "Juni",
        "month_7": "Juli",
        "month_8": "August",
        "month_9": "September",
        "month_10": "Oktober",
        "month_11": "November",
        "month_12": "Dezember",
    },
    "fr": {
        "bill_title": "Facture d'energie",
        "file_prefix": "facture",
        "from": "DE",
        "to": "A",
        "billing_period": "Periode de facturation",
        "consumption_cost": "Consommation & Couts",
        "description": "Description",
        "cost": "Couts",
        "revenue": "Revenus",
        "local_solar": "Solaire local",
        "grid_bkw": "Reseau (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenus",
        "sold_locally": "Vendu localement",
        "exported_to_grid": "Exporte vers le reseau",
        "total_cost": "Cout total",
        "total_revenue": "Revenu total",
        "net": "Net",
        "saved_with_solar": "Economise avec le solaire",
        "you_saved": "Vous avez economise {amount} {currency}  -  {pct}% de votre energie etait du solaire local!",
        "footer": "Genere par BKW vZEV Calculator",
        "daily_consumption_cost": "Consommation & Couts journaliers",
        "daily_production_revenue": "Production & Revenus journaliers",
        "day": "Jour",
        "local_kwh": "Local kWh",
        "grid_kwh": "Reseau kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "month_1": "Janvier",
        "month_2": "Fevrier",
        "month_3": "Mars",
        "month_4": "Avril",
        "month_5": "Mai",
        "month_6": "Juin",
        "month_7": "Juillet",
        "month_8": "Aout",
        "month_9": "Septembre",
        "month_10": "Octobre",
        "month_11": "Novembre",
        "month_12": "Decembre",
    },
    "it": {
        "bill_title": "Fattura energetica",
        "file_prefix": "fattura",
        "from": "DA",
        "to": "A",
        "billing_period": "Periodo di fatturazione",
        "consumption_cost": "Consumo & Costi",
        "description": "Descrizione",
        "cost": "Costi",
        "revenue": "Ricavi",
        "local_solar": "Solare locale",
        "grid_bkw": "Rete (BKW)",
        "total": "Totale",
        "production_revenue": "Produzione & Ricavi",
        "sold_locally": "Venduto localmente",
        "exported_to_grid": "Esportato in rete",
        "total_cost": "Costo totale",
        "total_revenue": "Ricavo totale",
        "net": "Netto",
        "saved_with_solar": "Risparmio con il solare",
        "you_saved": "Hai risparmiato {amount} {currency}  -  {pct}% della tua energia era solare locale!",
        "footer": "Generato da BKW vZEV Calculator",
        "daily_consumption_cost": "Consumo & Costi giornalieri",
        "daily_production_revenue": "Produzione & Ricavi giornalieri",
        "day": "Giorno",
        "local_kwh": "Locale kWh",
        "grid_kwh": "Rete kWh",
        "total_kwh": "Totale kWh",
        "prod_kwh": "Prod. kWh",
        "month_1": "Gennaio",
        "month_2": "Febbraio",
        "month_3": "Marzo",
        "month_4": "Aprile",
        "month_5": "Maggio",
        "month_6": "Giugno",
        "month_7": "Luglio",
        "month_8": "Agosto",
        "month_9": "Settembre",
        "month_10": "Ottobre",
        "month_11": "Novembre",
        "month_12": "Dicembre",
    },
}


def get_translations(language: str) -> dict[str, str]:
    """Return the translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _TRANSLATIONS:
        return _TRANSLATIONS["en"]
    return _TRANSLATIONS[lang]


def get_month_name(language: str, month: int) -> str:
    """Return the localised month name (1-12)."""
    t = get_translations(language)
    return t.get(f"month_{month}", f"Month {month}")
