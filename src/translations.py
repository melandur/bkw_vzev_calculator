"""Translations for PDF bill generation.

Supported languages: en, de, fr, it.
"""

from __future__ import annotations

_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "bill_title": "Energy Bill",
        "file_prefix": "bill",
        "from": "FROM",
        "to": "TO",
        "billing_period": "Billing period",
        "consumption_cost": "Consumption & Cost",
        "description": "Description",
        "cost": "Cost",
        "revenue": "Revenue",
        "local_solar": "Local solar",
        "grid_bkw": "Grid (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenue",
        "sold_locally": "Sold locally",
        "exported_to_grid": "Exported to grid",
        "total_cost": "Total cost",
        "total_revenue": "Total revenue",
        "net": "Net",
        "saved_with_solar": "Saved with local solar",
        "you_saved": "You saved {amount} {currency}  -  {pct}% of your energy was local solar!",
        "footer": "Generated by BKW vZEV Calculator",
        "daily_consumption_cost": "Daily Consumption & Cost",
        "daily_production_revenue": "Daily Production & Revenue",
        "day": "Day",
        "local_kwh": "Local kWh",
        "grid_kwh": "Grid kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        # Month names
        "month_1": "January",
        "month_2": "February",
        "month_3": "March",
        "month_4": "April",
        "month_5": "May",
        "month_6": "June",
        "month_7": "July",
        "month_8": "August",
        "month_9": "September",
        "month_10": "October",
        "month_11": "November",
        "month_12": "December",
    },
    "de": {
        "bill_title": "Energierechnung",
        "file_prefix": "rechnung",
        "from": "VON",
        "to": "AN",
        "billing_period": "Abrechnungszeitraum",
        "consumption_cost": "Verbrauch & Kosten",
        "description": "Beschreibung",
        "cost": "Kosten",
        "revenue": "Ertrag",
        "local_solar": "Lokal Solar",
        "grid_bkw": "Netz (BKW)",
        "total": "Total",
        "production_revenue": "Produktion & Ertrag",
        "sold_locally": "Lokal verkauft",
        "exported_to_grid": "Ins Netz eingespeist",
        "total_cost": "Gesamtkosten",
        "total_revenue": "Gesamtertrag",
        "net": "Netto",
        "saved_with_solar": "Ersparnis mit Solarstrom",
        "you_saved": "Sie sparten {amount} {currency}  -  {pct}% Ihres Stroms war lokaler Solarstrom!",
        "footer": "Erstellt mit BKW vZEV Calculator",
        "daily_consumption_cost": "Tagesverbrauch & Kosten",
        "daily_production_revenue": "Tagesproduktion & Ertrag",
        "day": "Tag",
        "local_kwh": "Lokal kWh",
        "grid_kwh": "Netz kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "month_1": "Januar",
        "month_2": "Februar",
        "month_3": "Maerz",
        "month_4": "April",
        "month_5": "Mai",
        "month_6": "Juni",
        "month_7": "Juli",
        "month_8": "August",
        "month_9": "September",
        "month_10": "Oktober",
        "month_11": "November",
        "month_12": "Dezember",
    },
    "fr": {
        "bill_title": "Facture d'energie",
        "file_prefix": "facture",
        "from": "DE",
        "to": "A",
        "billing_period": "Periode de facturation",
        "consumption_cost": "Consommation & Couts",
        "description": "Description",
        "cost": "Couts",
        "revenue": "Revenus",
        "local_solar": "Solaire local",
        "grid_bkw": "Reseau (BKW)",
        "total": "Total",
        "production_revenue": "Production & Revenus",
        "sold_locally": "Vendu localement",
        "exported_to_grid": "Exporte vers le reseau",
        "total_cost": "Cout total",
        "total_revenue": "Revenu total",
        "net": "Net",
        "saved_with_solar": "Economise avec le solaire",
        "you_saved": "Vous avez economise {amount} {currency}  -  {pct}% de votre energie etait du solaire local!",
        "footer": "Genere par BKW vZEV Calculator",
        "daily_consumption_cost": "Consommation & Couts journaliers",
        "daily_production_revenue": "Production & Revenus journaliers",
        "day": "Jour",
        "local_kwh": "Local kWh",
        "grid_kwh": "Reseau kWh",
        "total_kwh": "Total kWh",
        "prod_kwh": "Prod. kWh",
        "month_1": "Janvier",
        "month_2": "Fevrier",
        "month_3": "Mars",
        "month_4": "Avril",
        "month_5": "Mai",
        "month_6": "Juin",
        "month_7": "Juillet",
        "month_8": "Aout",
        "month_9": "Septembre",
        "month_10": "Octobre",
        "month_11": "Novembre",
        "month_12": "Decembre",
    },
    "it": {
        "bill_title": "Fattura energetica",
        "file_prefix": "fattura",
        "from": "DA",
        "to": "A",
        "billing_period": "Periodo di fatturazione",
        "consumption_cost": "Consumo & Costi",
        "description": "Descrizione",
        "cost": "Costi",
        "revenue": "Ricavi",
        "local_solar": "Solare locale",
        "grid_bkw": "Rete (BKW)",
        "total": "Totale",
        "production_revenue": "Produzione & Ricavi",
        "sold_locally": "Venduto localmente",
        "exported_to_grid": "Esportato in rete",
        "total_cost": "Costo totale",
        "total_revenue": "Ricavo totale",
        "net": "Netto",
        "saved_with_solar": "Risparmio con il solare",
        "you_saved": "Hai risparmiato {amount} {currency}  -  {pct}% della tua energia era solare locale!",
        "footer": "Generato da BKW vZEV Calculator",
        "daily_consumption_cost": "Consumo & Costi giornalieri",
        "daily_production_revenue": "Produzione & Ricavi giornalieri",
        "day": "Giorno",
        "local_kwh": "Locale kWh",
        "grid_kwh": "Rete kWh",
        "total_kwh": "Totale kWh",
        "prod_kwh": "Prod. kWh",
        "month_1": "Gennaio",
        "month_2": "Febbraio",
        "month_3": "Marzo",
        "month_4": "Aprile",
        "month_5": "Maggio",
        "month_6": "Giugno",
        "month_7": "Luglio",
        "month_8": "Agosto",
        "month_9": "Settembre",
        "month_10": "Ottobre",
        "month_11": "Novembre",
        "month_12": "Dicembre",
    },
}


def get_translations(language: str) -> dict[str, str]:
    """Return the translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _TRANSLATIONS:
        return _TRANSLATIONS["en"]
    return _TRANSLATIONS[lang]


def get_month_name(language: str, month: int) -> str:
    """Return the localised month name (1-12)."""
    t = get_translations(language)
    return t.get(f"month_{month}", f"Month {month}")


# ===========================================================================
# GUI translations (Streamlit app)
# ===========================================================================

_GUI_TRANSLATIONS: dict[str, dict[str, str]] = {
    "en": {
        "page_title": "BKW vZEV Calculator",
        "settings": "Settings",
        "csv_directory": "CSV directory",
        "output_directory": "Output directory",
        "database_path": "Database path",
        "collective": "Collective",
        "name": "Name",
        "language": "Language",
        "show_daily_detail": "Show daily detail in PDFs",
        "bill_months": "Bill months (comma-separated, e.g. 2025-10, 2025-11)",
        "period_start": "Period start",
        "period_end": "Period end",
        "rates": "Rates (CHF/kWh)",
        "local_rate": "Local rate",
        "bkw_buy_rate": "BKW buy rate",
        "bkw_sell_rate": "BKW sell rate",
        "members": "Members",
        "host": "Host",
        "member": "Member",
        "first_name": "First name",
        "last_name": "Last name",
        "street": "Street",
        "zip": "ZIP",
        "city": "City",
        "canton": "Canton",
        "is_host": "Is host",
        "meters": "Meters",
        "external_id": "External ID",
        "production": "Production",
        "virtual": "Virtual",
        "remove_meter": "Remove meter",
        "add_meter": "Add meter",
        "remove_member": "Remove member",
        "add_member": "Add member",
        "save_config": "Save config.toml",
        "run_pipeline": "Run pipeline",
        "config_not_found": "config.toml not found. Save the config first.",
        "running_pipeline": "Running pipeline...",
        "pipeline_success": "Pipeline completed successfully.",
        "pipeline_exit_error": "Pipeline exited with an error. Check the log below.",
        "pipeline_failed": "Pipeline failed: {error}",
        "saved_to": "Saved to {path}",
        "log_output": "Log output",
        "generated_files": "Generated files",
        "pdf_bills": "PDF bills",
        "csv_summaries": "CSV summaries",
    },
    "de": {
        "page_title": "BKW vZEV Rechner",
        "settings": "Einstellungen",
        "csv_directory": "CSV-Verzeichnis",
        "output_directory": "Ausgabeverzeichnis",
        "database_path": "Datenbankpfad",
        "collective": "Gemeinschaft",
        "name": "Name",
        "language": "Sprache",
        "show_daily_detail": "Tagesdetails in PDFs anzeigen",
        "bill_months": "Rechnungsmonate (kommagetrennt, z.B. 2025-10, 2025-11)",
        "period_start": "Periodenbeginn",
        "period_end": "Periodenende",
        "rates": "Tarife (CHF/kWh)",
        "local_rate": "Lokaltarif",
        "bkw_buy_rate": "BKW Bezugstarif",
        "bkw_sell_rate": "BKW Einspeisevergütung",
        "members": "Mitglieder",
        "host": "Gastgeber",
        "member": "Mitglied",
        "first_name": "Vorname",
        "last_name": "Nachname",
        "street": "Strasse",
        "zip": "PLZ",
        "city": "Ort",
        "canton": "Kanton",
        "is_host": "Ist Gastgeber",
        "meters": "Zähler",
        "external_id": "Externe ID",
        "production": "Produktion",
        "virtual": "Virtuell",
        "remove_meter": "Zähler entfernen",
        "add_meter": "Zähler hinzufügen",
        "remove_member": "Mitglied entfernen",
        "add_member": "Mitglied hinzufügen",
        "save_config": "config.toml speichern",
        "run_pipeline": "Pipeline ausführen",
        "config_not_found": "config.toml nicht gefunden. Speichern Sie zuerst die Konfiguration.",
        "running_pipeline": "Pipeline wird ausgeführt...",
        "pipeline_success": "Pipeline erfolgreich abgeschlossen.",
        "pipeline_exit_error": "Pipeline mit Fehler beendet. Siehe Log unten.",
        "pipeline_failed": "Pipeline fehlgeschlagen: {error}",
        "saved_to": "Gespeichert in {path}",
        "log_output": "Log-Ausgabe",
        "generated_files": "Generierte Dateien",
        "pdf_bills": "PDF-Rechnungen",
        "csv_summaries": "CSV-Zusammenfassungen",
    },
    "fr": {
        "page_title": "Calculateur BKW vZEV",
        "settings": "Parametres",
        "csv_directory": "Repertoire CSV",
        "output_directory": "Repertoire de sortie",
        "database_path": "Chemin base de donnees",
        "collective": "Collectif",
        "name": "Nom",
        "language": "Langue",
        "show_daily_detail": "Afficher details journaliers dans les PDFs",
        "bill_months": "Mois de facturation (separes par virgules, ex. 2025-10, 2025-11)",
        "period_start": "Debut de periode",
        "period_end": "Fin de periode",
        "rates": "Tarifs (CHF/kWh)",
        "local_rate": "Tarif local",
        "bkw_buy_rate": "Tarif achat BKW",
        "bkw_sell_rate": "Tarif vente BKW",
        "members": "Membres",
        "host": "Hote",
        "member": "Membre",
        "first_name": "Prenom",
        "last_name": "Nom de famille",
        "street": "Rue",
        "zip": "NPA",
        "city": "Ville",
        "canton": "Canton",
        "is_host": "Est hote",
        "meters": "Compteurs",
        "external_id": "ID externe",
        "production": "Production",
        "virtual": "Virtuel",
        "remove_meter": "Supprimer compteur",
        "add_meter": "Ajouter compteur",
        "remove_member": "Supprimer membre",
        "add_member": "Ajouter membre",
        "save_config": "Enregistrer config.toml",
        "run_pipeline": "Lancer le pipeline",
        "config_not_found": "config.toml introuvable. Enregistrez d'abord la configuration.",
        "running_pipeline": "Pipeline en cours...",
        "pipeline_success": "Pipeline termine avec succes.",
        "pipeline_exit_error": "Le pipeline s'est termine avec une erreur. Voir le log ci-dessous.",
        "pipeline_failed": "Echec du pipeline: {error}",
        "saved_to": "Enregistre dans {path}",
        "log_output": "Sortie du log",
        "generated_files": "Fichiers generes",
        "pdf_bills": "Factures PDF",
        "csv_summaries": "Resumes CSV",
    },
    "it": {
        "page_title": "Calcolatore BKW vZEV",
        "settings": "Impostazioni",
        "csv_directory": "Directory CSV",
        "output_directory": "Directory di output",
        "database_path": "Percorso database",
        "collective": "Collettivo",
        "name": "Nome",
        "language": "Lingua",
        "show_daily_detail": "Mostra dettagli giornalieri nei PDF",
        "bill_months": "Mesi di fatturazione (separati da virgola, es. 2025-10, 2025-11)",
        "period_start": "Inizio periodo",
        "period_end": "Fine periodo",
        "rates": "Tariffe (CHF/kWh)",
        "local_rate": "Tariffa locale",
        "bkw_buy_rate": "Tariffa acquisto BKW",
        "bkw_sell_rate": "Tariffa vendita BKW",
        "members": "Membri",
        "host": "Host",
        "member": "Membro",
        "first_name": "Nome",
        "last_name": "Cognome",
        "street": "Via",
        "zip": "CAP",
        "city": "Citta",
        "canton": "Cantone",
        "is_host": "E host",
        "meters": "Contatori",
        "external_id": "ID esterno",
        "production": "Produzione",
        "virtual": "Virtuale",
        "remove_meter": "Rimuovi contatore",
        "add_meter": "Aggiungi contatore",
        "remove_member": "Rimuovi membro",
        "add_member": "Aggiungi membro",
        "save_config": "Salva config.toml",
        "run_pipeline": "Esegui pipeline",
        "config_not_found": "config.toml non trovato. Salva prima la configurazione.",
        "running_pipeline": "Pipeline in esecuzione...",
        "pipeline_success": "Pipeline completata con successo.",
        "pipeline_exit_error": "Pipeline terminata con errore. Controlla il log qui sotto.",
        "pipeline_failed": "Pipeline fallita: {error}",
        "saved_to": "Salvato in {path}",
        "log_output": "Output del log",
        "generated_files": "File generati",
        "pdf_bills": "Fatture PDF",
        "csv_summaries": "Riepiloghi CSV",
    },
}


def get_gui_translations(language: str) -> dict[str, str]:
    """Return the GUI translation dict for the given language code.

    Falls back to English if the language is not supported.
    """
    lang = language.lower().strip()
    if lang not in _GUI_TRANSLATIONS:
        return _GUI_TRANSLATIONS["en"]
    return _GUI_TRANSLATIONS[lang]
